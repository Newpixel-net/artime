---
phase: 1.5-automatic-speech-flow
plan: 02
type: execute
wave: 2
depends_on: ["1.5-01"]
files_modified:
  - modules/AppVideoWizard/resources/views/livewire/steps/concept.blade.php
autonomous: true

must_haves:
  truths:
    - "Character Intelligence UI section is removed from concept.blade.php"
    - "Detection Summary panel is visible after script generation"
    - "Detection Summary shows detected characters with voice status"
    - "Detection Summary shows speech type counts (narrator, dialogue, internal, monologue)"
    - "Detection Summary is collapsed by default, expandable on click"
  artifacts:
    - path: "modules/AppVideoWizard/resources/views/livewire/steps/concept.blade.php"
      provides: "Detection Summary UI panel"
      contains: "vw-detection-summary"
  key_links:
    - from: "concept.blade.php"
      to: "$detectionSummary"
      via: "Livewire property binding"
      pattern: "detectionSummary"
---

<objective>
Replace Character Intelligence UI with Detection Summary panel.

Purpose: Remove the manual Character Intelligence configuration (narration style dropdown, character count slider) and replace it with a read-only Detection Summary panel that shows what was auto-detected from the script. Users don't need to configure anything - they just see the results.

Output: Clean UI with informational Detection Summary panel instead of manual configuration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/1.5-automatic-speech-flow/1.5-CONTEXT.md
@.planning/phases/1.5-automatic-speech-flow/1.5-RESEARCH.md
@.planning/phases/1.5-automatic-speech-flow/1.5-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Character Intelligence UI section</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/concept.blade.php</files>
  <action>
Remove the entire Character Intelligence UI section from concept.blade.php.

Location: Lines approximately 1065-1147 (the section starting with `{{-- Character Intelligence Section - Always visible --}}`).

Find and DELETE this entire block:
```blade
{{-- Character Intelligence Section - Always visible --}}
<div class="vw-character-intel-card ...">
    ...entire section including header, toggle, narration style buttons, character count slider...
</div>
```

The section to remove:
- Starts with: `{{-- Character Intelligence Section - Always visible --}}`
- Contains: `vw-character-intel-card` class
- Contains: narration style dropdown (`vw-narration-style-section`)
- Contains: character count slider (`vw-character-count-section`)
- Ends with the closing `</div>` of `vw-character-intel-card`

After removal, the concept step should flow directly from the concept variations section to the next element (likely end of step or navigation).
  </action>
  <verify>
Search for `vw-character-intel-card` - should NOT be found in concept.blade.php
Search for `Character Intelligence` - should NOT be found in concept.blade.php
Search for `narrationStyle` in concept.blade.php - should NOT be found
Search for `characterCount` slider in concept.blade.php - should NOT be found
  </verify>
  <done>
Character Intelligence UI section completely removed from concept.blade.php:
- No narration style dropdown
- No character count slider
- No Character Intelligence header/toggle
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Detection Summary panel</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/concept.blade.php</files>
  <action>
Add a new Detection Summary panel where the Character Intelligence section was removed.

Location: After the concept variations section (where Character Intelligence was).

Add this Blade template:
```blade
{{-- Detection Summary Panel - Read-only informational display --}}
@if(!empty($detectionSummary['totalSegments']) && $detectionSummary['totalSegments'] > 0)
<div class="vw-detection-summary-card" x-data="{ expanded: false }">
    {{-- Header (always visible) --}}
    <div class="vw-detection-summary-header" @click="expanded = !expanded" style="cursor: pointer;">
        <div class="vw-detection-summary-left">
            <div class="vw-detection-summary-icon">&#128269;</div>
            <div>
                <h3 class="vw-detection-summary-title">{{ __('Detection Summary') }}</h3>
                <p class="vw-detection-summary-subtitle">{{ __('Auto-detected from your script') }}</p>
            </div>
        </div>
        <div class="vw-detection-summary-badges">
            @if(count($detectionSummary['characters'] ?? []) > 0)
                <span class="vw-summary-badge characters">
                    {{ count($detectionSummary['characters']) }} {{ __('characters') }}
                </span>
            @endif
            <span class="vw-summary-badge segments">
                {{ $detectionSummary['totalSegments'] }} {{ __('segments') }}
            </span>
            <button type="button" class="vw-expand-btn" :class="{ 'expanded': expanded }">
                <svg x-show="!expanded" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
                <svg x-show="expanded" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="18 15 12 9 6 15"></polyline>
                </svg>
            </button>
        </div>
    </div>

    {{-- Expandable Content --}}
    <div x-show="expanded" x-collapse class="vw-detection-summary-content">
        {{-- Characters Detected --}}
        @if(!empty($detectionSummary['characters']))
            <div class="vw-summary-section">
                <h4 class="vw-summary-section-title">{{ __('Characters Detected') }}</h4>
                <div class="vw-character-chips">
                    @foreach($detectionSummary['characters'] as $char)
                        <span class="vw-chip {{ !empty($char['voiceId']) ? 'has-voice' : 'no-voice' }}">
                            {{ $char['name'] }}
                            @if(!empty($char['voiceId']))
                                <span class="vw-chip-icon" title="{{ __('Voice assigned') }}">&#10003;</span>
                            @else
                                <span class="vw-chip-icon warning" title="{{ __('No voice assigned') }}">!</span>
                            @endif
                        </span>
                    @endforeach
                </div>
                <a href="#" wire:click.prevent="openCharacterBible" class="vw-summary-link">
                    &#8594; {{ __('Edit in Character Bible') }}
                </a>
            </div>
        @endif

        {{-- Speech Types Found --}}
        @if(!empty($detectionSummary['speechTypes']))
            <div class="vw-summary-section">
                <h4 class="vw-summary-section-title">{{ __('Speech Types') }}</h4>
                <div class="vw-speech-type-stats">
                    @php
                        $typeIcons = [
                            'narrator' => '&#127897;',  // Microphone
                            'dialogue' => '&#128172;',  // Speech bubble
                            'internal' => '&#128173;',  // Thought bubble
                            'monologue' => '&#128483;', // Speaking head
                        ];
                        $typeLabels = [
                            'narrator' => 'Narrator',
                            'dialogue' => 'Dialogue',
                            'internal' => 'Internal',
                            'monologue' => 'Monologue',
                        ];
                    @endphp
                    @foreach($detectionSummary['speechTypes'] as $type => $count)
                        @if($count > 0)
                            <div class="vw-speech-stat">
                                <span class="vw-speech-stat-icon">{!! $typeIcons[$type] ?? '&#10067;' !!}</span>
                                <span class="vw-speech-stat-label">{{ __($typeLabels[$type] ?? ucfirst($type)) }}</span>
                                <span class="vw-speech-stat-value">{{ $count }}</span>
                            </div>
                        @endif
                    @endforeach
                </div>
            </div>
        @endif

        {{-- Lip-sync Summary --}}
        <div class="vw-summary-section">
            <h4 class="vw-summary-section-title">{{ __('Audio Requirements') }}</h4>
            <div class="vw-audio-stats">
                <div class="vw-audio-stat">
                    <span class="vw-audio-stat-icon">&#127909;</span>
                    <span class="vw-audio-stat-label">{{ __('Needs Lip-sync') }}</span>
                    <span class="vw-audio-stat-value">{{ $detectionSummary['needsLipSync'] ?? 0 }}</span>
                </div>
                <div class="vw-audio-stat">
                    <span class="vw-audio-stat-icon">&#127897;</span>
                    <span class="vw-audio-stat-label">{{ __('Voiceover Only') }}</span>
                    <span class="vw-audio-stat-value">{{ $detectionSummary['voiceoverOnly'] ?? 0 }}</span>
                </div>
                @if(!empty($detectionSummary['estimatedDuration']))
                    <div class="vw-audio-stat">
                        <span class="vw-audio-stat-icon">&#9201;</span>
                        <span class="vw-audio-stat-label">{{ __('Est. Duration') }}</span>
                        <span class="vw-audio-stat-value">{{ gmdate('i:s', (int)$detectionSummary['estimatedDuration']) }}</span>
                    </div>
                @endif
            </div>
        </div>
    </div>
</div>
@endif
```

This panel:
- Only shows when detectionSummary has data (after script generation)
- Collapsed by default (x-data="{ expanded: false }")
- Shows character count and segment count badges always
- Expandable to show full details
- Read-only - no user configuration needed
  </action>
  <verify>
Search for `vw-detection-summary-card` - should be found in concept.blade.php
Search for `detectionSummary` - should be found in concept.blade.php
Search for `x-data.*expanded` - should be found (Alpine.js state)
  </verify>
  <done>
Detection Summary panel added to concept.blade.php:
- Shows after script is generated and parsed
- Displays detected characters with voice status
- Shows speech type breakdown
- Shows lip-sync vs voiceover counts
- Collapsed by default, expandable
- Link to Character Bible for editing
  </done>
</task>

<task type="auto">
  <name>Task 3: Add CSS styles for Detection Summary</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/concept.blade.php</files>
  <action>
Add CSS styles for the Detection Summary panel to the existing `<style>` block at the top of concept.blade.php.

Location: Inside the existing `<style>` tag (starts around line 2), add these styles:

```css
/* Detection Summary Panel - Read-only informational display */
.vw-concept-step .vw-detection-summary-card {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(6, 95, 70, 0.15) 100%);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 0.75rem;
    padding: 1rem;
    margin-bottom: 1.5rem;
}

.vw-concept-step .vw-detection-summary-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
}

.vw-concept-step .vw-detection-summary-left {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.vw-concept-step .vw-detection-summary-icon {
    font-size: 1.5rem;
}

.vw-concept-step .vw-detection-summary-title {
    font-size: 1rem;
    font-weight: 600;
    color: #ffffff;
    margin: 0;
}

.vw-concept-step .vw-detection-summary-subtitle {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    margin: 0;
}

.vw-concept-step .vw-detection-summary-badges {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.vw-concept-step .vw-summary-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
}

.vw-concept-step .vw-summary-badge.characters {
    background: rgba(139, 92, 246, 0.3);
    color: #c4b5fd;
}

.vw-concept-step .vw-summary-badge.segments {
    background: rgba(16, 185, 129, 0.3);
    color: #6ee7b7;
}

.vw-concept-step .vw-expand-btn {
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    padding: 0.25rem;
    transition: transform 0.2s ease;
}

.vw-concept-step .vw-expand-btn:hover {
    color: #ffffff;
}

.vw-concept-step .vw-expand-btn.expanded {
    transform: rotate(180deg);
}

.vw-concept-step .vw-detection-summary-content {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.vw-concept-step .vw-summary-section {
    margin-bottom: 1rem;
}

.vw-concept-step .vw-summary-section:last-child {
    margin-bottom: 0;
}

.vw-concept-step .vw-summary-section-title {
    font-size: 0.75rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.7);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0 0 0.5rem 0;
}

.vw-concept-step .vw-character-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.vw-concept-step .vw-chip {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.375rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.8rem;
    font-weight: 500;
}

.vw-concept-step .vw-chip.has-voice {
    background: rgba(16, 185, 129, 0.2);
    color: #6ee7b7;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.vw-concept-step .vw-chip.no-voice {
    background: rgba(251, 191, 36, 0.2);
    color: #fcd34d;
    border: 1px solid rgba(251, 191, 36, 0.3);
}

.vw-concept-step .vw-chip-icon {
    font-size: 0.75rem;
}

.vw-concept-step .vw-chip-icon.warning {
    color: #fbbf24;
}

.vw-concept-step .vw-summary-link {
    font-size: 0.8rem;
    color: #a78bfa;
    text-decoration: none;
}

.vw-concept-step .vw-summary-link:hover {
    color: #c4b5fd;
    text-decoration: underline;
}

.vw-concept-step .vw-speech-type-stats,
.vw-concept-step .vw-audio-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
}

.vw-concept-step .vw-speech-stat,
.vw-concept-step .vw-audio-stat {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(0, 0, 0, 0.2);
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
}

.vw-concept-step .vw-speech-stat-icon,
.vw-concept-step .vw-audio-stat-icon {
    font-size: 1rem;
}

.vw-concept-step .vw-speech-stat-label,
.vw-concept-step .vw-audio-stat-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
}

.vw-concept-step .vw-speech-stat-value,
.vw-concept-step .vw-audio-stat-value {
    font-size: 0.875rem;
    font-weight: 600;
    color: #ffffff;
}
```
  </action>
  <verify>
Search for `vw-detection-summary-card` in CSS - styles should exist
Search for `vw-chip.has-voice` - style should exist
Search for `vw-speech-stat` - style should exist
  </verify>
  <done>
CSS styles added for Detection Summary panel:
- Clean, informational design (green accent for "detected/confirmed")
- Character chips with voice status indicators
- Speech type statistics grid
- Audio requirements summary
- Responsive layout
- Matches existing wizard visual style
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. UI Check:
   - Load the concept step in browser
   - Character Intelligence section should NOT be visible
   - After script generation, Detection Summary should appear

2. Functionality Check:
   - Detection Summary collapsed by default
   - Click header to expand
   - Characters show with voice status icons
   - Speech types show counts
   - Link to Character Bible works

3. No regressions:
   - Concept step loads without errors
   - Script generation still works
   - Other UI elements unaffected
</verification>

<success_criteria>
- [ ] Character Intelligence UI section removed (no narration style dropdown, no character count slider)
- [ ] Detection Summary panel added with collapsible behavior
- [ ] Detection Summary shows detected characters
- [ ] Detection Summary shows speech type breakdown
- [ ] Detection Summary shows lip-sync vs voiceover counts
- [ ] CSS styles render correctly
- [ ] Panel only shows when detectionSummary has data
- [ ] No console errors on page load
</success_criteria>

<output>
After completion, create `.planning/phases/1.5-automatic-speech-flow/1.5-02-SUMMARY.md`
</output>
