---
phase: 10-mobile-responsiveness-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php
autonomous: false

must_haves:
  truths:
    - "Modal displays fullscreen on mobile devices (viewport < 768px)"
    - "Modal displays as centered box on desktop (viewport >= 769px)"
    - "Close button is accessible with one-handed thumb operation on mobile"
    - "Background page does not scroll when modal is open on iOS Safari"
    - "Copy buttons provide feedback on touch devices"
  artifacts:
    - path: "modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php"
      provides: "Mobile responsive Scene Text Inspector modal"
      contains:
        - "@media (max-width: 768px)"
        - "100dvh"
        - "min-width: 48px"
        - "min-height: 48px"
        - "position: fixed"
        - "overscroll-behavior"
  key_links:
    - from: "modal overlay x-init"
      to: "body scroll lock"
      via: "Alpine.js sets document.body.style.position = 'fixed'"
      pattern: "document\\.body\\.style\\.position.*fixed"
    - from: "modal close handler"
      to: "scroll restoration"
      via: "restores scrollY position on close"
      pattern: "window\\.scrollTo\\(0,.*scrollY"
---

<objective>
Make Scene Text Inspector modal fully responsive for mobile devices with professional touch interactions.

Purpose: Users on mobile devices need a seamless experience viewing scene content. Currently the modal is desktop-optimized and may have issues with scroll locking, button accessibility, and layout on small screens.

Output: Mobile-responsive modal that displays fullscreen on mobile (<768px), has thumb-accessible close button, locked body scroll on iOS Safari, and touch-optimized copy buttons.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-mobile-responsiveness-polish/10-RESEARCH.md

# Target file
@modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php

# Reference patterns (existing responsive modals)
@modules/AppVideoWizard/resources/views/livewire/modals/character-bible.blade.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add iOS Safari scroll lock and mobile responsive layout</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php</files>
  <action>
Update the modal overlay to implement iOS Safari scroll lock and responsive layout:

1. **Add Alpine.js x-data for scroll management:**
   - Replace current x-data on overlay with expanded version including scrollY tracking
   - On modal open (x-init): Store window.scrollY, set body position:fixed with top:-scrollY, add body.modal-open class
   - On modal close (via @close-modal.window event dispatch or wire:click handler): Restore body position, remove class, call window.scrollTo(0, scrollY)

2. **Add CSS media queries inside a style block:**
   ```css
   /* Mobile fullscreen */
   @media (max-width: 768px) {
       .vw-modal-overlay { padding: 0 !important; }
       .vw-modal {
           width: 100% !important;
           max-width: none !important;
           height: 100% !important;
           max-height: 100dvh !important;
           border-radius: 0 !important;
       }
   }

   /* Prevent body scroll when modal open */
   body.modal-open {
       position: fixed;
       width: 100%;
       overflow: hidden;
       overscroll-behavior: none;
   }
   ```

3. **Update modal container (div.vw-modal) styles:**
   - Keep existing desktop max-width: 920px
   - Add max-height: 100dvh as fallback alongside 96vh
   - Ensure overflow: hidden on container, overflow-y: auto on content div

4. **Add x-init and cleanup in Alpine.js on overlay:**
   Pattern to follow (from research):
   ```blade
   x-data="{
       scrollY: 0
   }"
   x-init="
       scrollY = window.scrollY;
       document.body.style.position = 'fixed';
       document.body.style.top = `-${scrollY}px`;
       document.body.style.width = '100%';
       document.body.classList.add('modal-open');
   "
   @keydown.escape.window="
       document.body.style.position = '';
       document.body.style.top = '';
       document.body.style.width = '';
       document.body.classList.remove('modal-open');
       window.scrollTo(0, scrollY);
       $wire.closeSceneTextInspector();
   "
   ```

5. **Update wire:click="closeSceneTextInspector" handlers:**
   Add scroll restoration before closing. Update close button click to:
   ```
   @click="
       document.body.style.position = '';
       document.body.style.top = '';
       document.body.style.width = '';
       document.body.classList.remove('modal-open');
       window.scrollTo(0, $data.scrollY);
       $wire.closeSceneTextInspector();
   "
   ```
   (Do the same for the @click.outside handler)

**CRITICAL:** Use 100dvh (dynamic viewport height) instead of 100vh for mobile - this handles iOS Safari address bar correctly.

**AVOID:** Don't use body-scroll-lock library (adds unnecessary dependency). CSS + Alpine.js is sufficient.
  </action>
  <verify>
    1. Open dev tools, set viewport to 375x667 (iPhone SE) - modal should be fullscreen
    2. Set viewport to 1200x800 (desktop) - modal should be centered 920px max-width
    3. Check body element in inspector - should have position:fixed when modal open
    4. Close modal - body should return to normal, no scroll jump
  </verify>
  <done>
    - Modal fullscreen on mobile (under 768px)
    - Modal centered box on desktop (over 768px)
    - Body scroll locked while modal open
    - Scroll position restored on close
  </done>
</task>

<task type="auto">
  <name>Task 2: Touch-optimize buttons and reposition close button for thumb zone</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php</files>
  <action>
Make all interactive elements touch-friendly and reposition close button for mobile:

1. **Update header close button (x) with minimum hit area:**
   Current: `padding: 0.25rem; line-height: 1;`
   Update to: `min-width: 48px; min-height: 48px; display: flex; align-items: center; justify-content: center;`

2. **Add mobile-specific footer close button:**
   On mobile, the footer close button needs to be more prominent and in thumb zone.
   Update footer button styles:
   ```
   min-width: 48px;
   min-height: 48px;
   padding: 0.75rem 1.5rem; /* Larger on mobile */
   ```

   Add mobile-specific CSS:
   ```css
   @media (max-width: 768px) {
       /* Footer sticky at bottom for thumb access */
       .vw-modal > div:last-child {
           position: sticky;
           bottom: 0;
           background: rgba(20,20,35,0.98);
           border-top: 1px solid rgba(255,255,255,0.15);
           padding: 0.75rem 1rem;
       }

       /* Full-width close button on mobile */
       .vw-modal > div:last-child button {
           width: 100%;
           min-height: 48px;
           font-size: 0.875rem;
       }
   }
   ```

3. **Update copy buttons with touch optimization:**
   Current copy buttons have: `padding: 0.2rem 0.5rem; font-size: 0.6rem;`

   Add touch-action and minimum size:
   ```
   min-width: 48px;
   min-height: 44px;
   padding: 0.5rem 0.75rem;
   touch-action: manipulation;
   ```

   Add @touchstart/@touchend handlers for visual feedback (optional but recommended):
   ```blade
   x-data="{ copied: false, touching: false }"
   @touchstart="touching = true"
   @touchend="touching = false"
   :style="touching ? 'background: rgba(139,92,246,0.4)' : 'background: rgba(139,92,246,0.2)'"
   ```

4. **Update collapsible section scrollable areas:**
   Add momentum scrolling for iOS:
   ```css
   .vw-modal [style*="overflow-y: auto"] {
       -webkit-overflow-scrolling: touch;
   }
   ```

   Or add inline to the content div: `-webkit-overflow-scrolling: touch;`

5. **Ensure consistent button styling across mobile:**
   Add to the style block:
   ```css
   @media (max-width: 768px) {
       /* Larger text for readability */
       .vw-modal h3 { font-size: 1.125rem; }
       .vw-modal h4 { font-size: 0.9rem; }
       .vw-modal p { font-size: 0.8rem; }

       /* Larger badges for touch */
       .vw-modal [style*="font-size: 0.6"] {
           font-size: 0.7rem !important;
           padding: 0.25rem 0.5rem !important;
       }
   }
   ```

**CRITICAL:** All buttons must have min-width: 48px and min-height: 48px for reliable touch targeting.

**AVOID:** Don't rely on :hover states for touch feedback - use @touchstart/@touchend instead.
  </action>
  <verify>
    1. On mobile viewport, check copy buttons have adequate tap area (should be easy to tap)
    2. Footer close button should be full-width and sticky at bottom
    3. Use Chrome DevTools touch simulation - tapping buttons should feel responsive
    4. Text should be readable without zooming
  </verify>
  <done>
    - All buttons have 48px minimum hit area
    - Copy buttons have touch feedback
    - Footer close button is prominent and thumb-accessible
    - Text sizes are readable on mobile
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Mobile responsive Scene Text Inspector modal with:
    - Fullscreen layout on mobile (under 768px)
    - Centered box on desktop (over 768px)
    - iOS Safari scroll lock (body position:fixed)
    - Touch-optimized buttons (48px hit areas)
    - Thumb-zone close button positioning
    - Touch feedback on copy buttons
  </what-built>
  <how-to-verify>
    **Desktop verification (Chrome/Firefox):**
    1. Open the Video Wizard step with scene cards
    2. Click "Inspect" on any scene card to open modal
    3. Modal should appear centered, max-width 920px
    4. Background should not scroll (try scrolling with mouse)
    5. Close modal - page should return to same scroll position

    **Mobile simulation (Chrome DevTools):**
    1. Open DevTools (F12) > Toggle device toolbar (Ctrl+Shift+M)
    2. Select iPhone 12 Pro (390x844) or similar
    3. Open scene inspector modal
    4. Modal should be fullscreen (no rounded corners, full width/height)
    5. Close button in footer should be full-width and easy to tap
    6. Copy buttons should have visible tap area
    7. Scroll within modal content - should be smooth
    8. Try to scroll background - should not scroll

    **Real iOS device (if available):**
    1. Open on iPhone Safari
    2. Open modal - should be fullscreen
    3. Try scrolling the background - should be locked
    4. Close modal - should return to original position
    5. Tap copy button - should show "Copied!" feedback

    **Expected behavior:**
    - Modal fullscreen on mobile viewports under 768px
    - Modal centered box on desktop viewports 769px+
    - No background scroll on any device
    - All buttons easily tappable on mobile
  </how-to-verify>
  <resume-signal>Type "approved" if mobile experience is smooth, or describe any issues with specific viewport sizes or interactions.</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:

1. **MODL-05 requirement check:**
   - [ ] Modal displays fullscreen on mobile (under 768px)
   - [ ] Modal displays centered box on desktop (over 768px)
   - [ ] Close button accessible with thumb on mobile
   - [ ] Body scroll locked on iOS Safari
   - [ ] All interactive elements work on touch devices

2. **Visual consistency:**
   - [ ] Colors match Character Bible and Location Bible modals
   - [ ] Spacing follows same patterns
   - [ ] Typography is readable on mobile

3. **No regressions:**
   - [ ] Desktop modal still works correctly
   - [ ] Copy-to-clipboard still works
   - [ ] Escape key still closes modal
   - [ ] Click outside still closes modal
</verification>

<success_criteria>
Phase 10 success criteria from ROADMAP.md:
1. Modal displays fullscreen on mobile devices (under 768px) and centered box on desktop
2. Close button positioned in bottom-right thumb zone on mobile for one-handed operation
3. Body scroll locked on iOS Safari when modal open (no background scrolling)
4. Modal styling matches existing Character Bible and Location Bible modals (consistent colors, spacing, typography)
5. All interactive elements (copy buttons, close button, collapsible sections) work smoothly on touch devices
</success_criteria>

<output>
After completion, create `.planning/phases/10-mobile-responsiveness-polish/10-01-SUMMARY.md`
</output>
