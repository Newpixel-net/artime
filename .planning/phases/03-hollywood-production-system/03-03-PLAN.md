---
phase: 03-hollywood-production-system
plan: 03
type: execute
wave: 2
depends_on: ["03-01", "03-02"]
files_modified:
  - modules/AppVideoWizard/database/seeders/VwSettingSeeder.php
  - modules/AppVideoWizard/app/Livewire/VideoWizard.php
autonomous: true
user_setup: []

must_haves:
  truths:
    - "shot_progression_enabled setting defaults to true"
    - "cinematic_intelligence_enabled setting defaults to true"
    - "Settings are seeded if missing"
  artifacts:
    - path: "modules/AppVideoWizard/database/seeders/VwSettingSeeder.php"
      provides: "Default settings for Hollywood features"
      contains: "shot_progression_enabled"
  key_links:
    - from: "VwSettingSeeder.php"
      to: "ShotProgressionService"
      via: "shot_progression_enabled setting"
      pattern: "shot_progression_enabled"
---

<objective>
Enable the Shot Progression and Cinematic Intelligence services by default.

**PROBLEM:** These services exist and are integrated, but may be disabled by default in database settings. This means:
- Shot variety across scenes may not be enforced
- Character state tracking may be disabled
- Shot validation may be skipped

Purpose: Ensure all Hollywood features are ON by default for production-quality output.

Output: All Hollywood intelligence features enabled and working.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@modules/AppVideoWizard/app/Services/ShotProgressionService.php
@modules/AppVideoWizard/app/Services/CinematicIntelligenceService.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Ensure Hollywood settings exist and are enabled</name>
  <files>modules/AppVideoWizard/database/seeders/VwSettingSeeder.php</files>
  <action>
Find or create the VwSettingSeeder and ensure these settings are present with enabled defaults:

Look for existing settings in the seeder. Add or update these settings:

```php
// Hollywood Production Features (Phase 3)
[
    'key' => 'shot_progression_enabled',
    'value' => 'true',
    'type' => 'boolean',
    'description' => 'Enable shot progression for variety across scenes',
    'group' => 'hollywood',
],
[
    'key' => 'cinematic_intelligence_enabled',
    'value' => 'true',
    'type' => 'boolean',
    'description' => 'Enable cinematic intelligence for character tracking',
    'group' => 'hollywood',
],
[
    'key' => 'hollywood_shot_sequences_enabled',
    'value' => 'true',
    'type' => 'boolean',
    'description' => 'Enable Hollywood shot sequence patterns',
    'group' => 'hollywood',
],
[
    'key' => 'emotional_arc_shot_mapping_enabled',
    'value' => 'true',
    'type' => 'boolean',
    'description' => 'Map emotional intensity to shot types',
    'group' => 'hollywood',
],
[
    'key' => 'dialogue_coverage_patterns_enabled',
    'value' => 'true',
    'type' => 'boolean',
    'description' => 'Apply shot/reverse shot patterns to dialogue',
    'group' => 'hollywood',
],
```

If the seeder doesn't exist, create it with the standard Laravel seeder structure.

WHY: Features that are implemented but disabled by default provide zero value. Users should get Hollywood quality by default.
  </action>
  <verify>
    - Settings seeder includes `shot_progression_enabled = true`
    - Settings seeder includes `cinematic_intelligence_enabled = true`
    - Settings seeder includes `hollywood_shot_sequences_enabled = true`
    - No PHP syntax errors: `php -l modules/AppVideoWizard/database/seeders/VwSettingSeeder.php`
  </verify>
  <done>Hollywood feature settings are defined with enabled defaults</done>
</task>

<task type="auto">
  <name>Task 2: Add runtime setting initialization</name>
  <files>modules/AppVideoWizard/app/Livewire/VideoWizard.php</files>
  <action>
In the mount() method or initialization section of VideoWizard, add code to ensure Hollywood settings have values even if the seeder hasn't run:

Find the section where dynamic settings are loaded (probably after `loadDynamicSettings()` call) and add:

```php
// PHASE 3: Ensure Hollywood features are enabled by default
$this->ensureHollywoodSettingsExist();
```

Then add the helper method:

```php
/**
 * Ensure Hollywood production settings exist with enabled defaults.
 * Called on mount to enable features even before seeder runs.
 */
protected function ensureHollywoodSettingsExist(): void
{
    $hollywoodDefaults = [
        'shot_progression_enabled' => 'true',
        'cinematic_intelligence_enabled' => 'true',
        'hollywood_shot_sequences_enabled' => 'true',
        'emotional_arc_shot_mapping_enabled' => 'true',
        'dialogue_coverage_patterns_enabled' => 'true',
    ];

    foreach ($hollywoodDefaults as $key => $default) {
        if (VwSetting::getValue($key) === null) {
            VwSetting::setValue($key, $default);
            Log::info("VideoWizard: Initialized missing Hollywood setting", [
                'key' => $key,
                'value' => $default,
            ]);
        }
    }
}
```

WHY: This ensures Hollywood features work even in development environments where seeders haven't run, or in production before a migration is deployed.
  </action>
  <verify>
    - `ensureHollywoodSettingsExist()` method exists
    - Method is called during mount/initialization
    - Settings are created if missing
    - No PHP syntax errors: `php -l modules/AppVideoWizard/app/Livewire/VideoWizard.php`
  </verify>
  <done>Hollywood settings are initialized at runtime if missing</done>
</task>

<task type="auto">
  <name>Task 3: Verify ShotProgressionService is connected</name>
  <files>modules/AppVideoWizard/app/Livewire/VideoWizard.php</files>
  <action>
Verify that ShotProgressionService is properly initialized and passed to ShotIntelligenceService.

Search for where ShotIntelligenceService is created/used and ensure progression service is set:

```php
// Look for existing code like:
$this->shotIntelligenceService = new ShotIntelligenceService(...);

// Ensure progression service is passed or set:
$progressionService = new ShotProgressionService();
$this->shotIntelligenceService->setProgressionService($progressionService);

// Or check if it's already being done via constructor injection
```

If the connection isn't there, add it in the mount() method or where ShotIntelligenceService is initialized.

WHY: ShotProgressionService prevents repetitive shot sequences, but only if it's actually connected to the intelligence service.
  </action>
  <verify>
    - ShotProgressionService is instantiated
    - ShotIntelligenceService has progression service set
    - No PHP syntax errors
  </verify>
  <done>ShotProgressionService is connected and will prevent repetitive shots</done>
</task>

</tasks>

<verification>
1. PHP syntax check on all modified files
2. Settings are queryable: `VwSetting::getValue('shot_progression_enabled')` returns 'true'
3. ShotProgressionService is connected to ShotIntelligenceService
4. Grep for Hollywood settings initialization
</verification>

<success_criteria>
- All Hollywood feature settings exist and default to enabled
- Settings are created at runtime if missing
- ShotProgressionService is properly connected
- CinematicIntelligenceService is enabled
- PHP syntax valid
</success_criteria>

<output>
After completion, create `.planning/phases/03-hollywood-production-system/03-03-SUMMARY.md`
</output>
