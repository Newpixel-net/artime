---
phase: 07-foundation-modal-shell-scene-card-fixes-metadata
plan: 03
type: execute
wave: 2
depends_on: ["07-02"]
files_modified:
  - modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php
autonomous: true

must_haves:
  truths:
    - User can view scene duration in modal
    - User can view scene transition type in modal
    - User can view scene location in modal
    - User can view characters present in scene
    - User can view emotional intensity indicator
    - Climax scenes show climax badge prominently
  artifacts:
    - path: modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php
      provides: Scene metadata display section
      min_lines: 150
      contains: "Metadata section with badges"
  key_links:
    - from: scene-text-inspector.blade.php metadata section
      to: "$scene['metadata']"
      via: "Direct array access for duration, transition, location"
      pattern: "\\$scene\\['metadata'\\]"
    - from: scene-text-inspector.blade.php characters section
      to: "$scene['characters']"
      via: "Array iteration for character list"
      pattern: "foreach.*\\$scene\\['characters'\\]"
    - from: scene-text-inspector.blade.php intensity display
      to: "$scene['emotionalIntensity']"
      via: "Intensity level to visual badge mapping"
      pattern: "\\$scene\\['emotionalIntensity'\\]"
---

<objective>
Add comprehensive scene metadata display to Scene Text Inspector modal with badges for duration, transition, location, characters, intensity, and climax indicator.

Purpose: Users need to see complete scene metadata that's not visible in compact storyboard cards. Metadata provides context for understanding scene structure and emotional flow.

Output: Metadata section in modal displaying 6 metadata types (META-01 through META-06) with professional badge UI matching existing storyboard styles.
</objective>

<execution_context>
@C:\Users\VoltaPsy\AppData\Roaming\Claude\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\VoltaPsy\AppData\Roaming\Claude\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@C:\Users\VoltaPsy\Documents\GitHub\artime\.planning\PROJECT.md
@C:\Users\VoltaPsy\Documents\GitHub\artime\.planning\ROADMAP.md
@C:\Users\VoltaPsy\Documents\GitHub\artime\.planning\STATE.md
@C:\Users\VoltaPsy\Documents\GitHub\artime\.planning\REQUIREMENTS.md
@C:\Users\VoltaPsy\Documents\GitHub\artime\.planning\research\SUMMARY.md

Scene data structure reference:
- $scene['metadata']['duration'] - Scene duration in seconds
- $scene['metadata']['transition'] - Transition type (CUT, FADE, DISSOLVE, etc.)
- $scene['location'] - Location string or object
- $scene['characters'] - Array of character names/objects
- $scene['emotionalIntensity'] - Intensity level (1-10 or string)
- $scene['isClimax'] - Boolean flag for climax scenes

Existing storyboard badge styles (for consistency):
@C:\Users\VoltaPsy\Documents\GitHub\artime\modules\AppVideoWizard\resources\views\livewire\steps\storyboard.blade.php
- Lines 900-1000: Badge styles (vw-shot-badge, vw-status-badge, vw-intensity-fill)
- Lines 2400-2450: Metadata badge rendering examples
</context>

<tasks>

<task type="auto">
  <name>Create metadata section UI structure in modal content area</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php</files>
  <action>
    Replace the placeholder content section (lines ~50-60) with comprehensive metadata display:

    1. Add metadata container structure:
       ```blade
       {{-- Content --}}
       <div style="flex: 1; overflow-y: auto; padding: 1rem;">
           @if($scene)
               {{-- METADATA SECTION --}}
               <div style="margin-bottom: 1.5rem;">
                   <h4 style="margin: 0 0 0.75rem 0; color: rgba(255,255,255,0.9); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;">
                       üìä Scene Metadata
                   </h4>

                   {{-- Metadata Grid --}}
                   <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                       {{-- Badges will be added in subtasks --}}
                   </div>
               </div>

               {{-- Speech segments section (placeholder for Phase 8) --}}
               <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; text-align: center; color: rgba(255,255,255,0.6); margin-bottom: 1.5rem;">
                   üéôÔ∏è Speech segments display coming in Phase 8
               </div>

               {{-- Prompts section (placeholder for Phase 9) --}}
               <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; text-align: center; color: rgba(255,255,255,0.6);">
                   üìù Prompts display coming in Phase 9
               </div>
           @else
               <div style="padding: 2rem; text-align: center; color: rgba(255,255,255,0.4);">
                   {{ __('Scene not found') }}
               </div>
           @endif
       </div>
       ```

    Why grid layout: Metadata badges vary in width. Auto-fit grid with minmax(200px, 1fr) creates responsive layout that works on mobile and desktop without media queries.
  </action>
  <verify>
    Read scene-text-inspector.blade.php and confirm metadata section structure exists with grid layout.
  </verify>
  <done>
    Modal content area has metadata section with heading and responsive grid layout ready for metadata badges.
  </done>
</task>

<task type="auto">
  <name>Add duration, transition, and location metadata badges</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php</files>
  <action>
    Add META-01, META-02, META-03 badges to metadata grid:

    1. Duration badge (META-01):
       ```blade
       {{-- Duration --}}
       @php
           $duration = $scene['metadata']['duration'] ?? $scene['duration'] ?? 0;
           $durationFormatted = $duration > 0 ? gmdate('i:s', $duration) : 'Unknown';
       @endphp
       <div style="padding: 0.6rem; background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
           <div style="font-size: 1.2rem;">‚è±Ô∏è</div>
           <div style="flex: 1;">
               <div style="font-size: 0.65rem; color: rgba(255,255,255,0.6); text-transform: uppercase; margin-bottom: 0.15rem;">Duration</div>
               <div style="font-size: 0.85rem; color: white; font-weight: 600;">{{ $durationFormatted }}</div>
           </div>
       </div>
       ```

    2. Transition badge (META-02):
       ```blade
       {{-- Transition --}}
       @php
           $transition = $scene['transition'] ?? $scene['metadata']['transition'] ?? 'CUT';
           $transitionIcons = [
               'CUT' => '‚úÇÔ∏è',
               'FADE' => 'üå´Ô∏è',
               'DISSOLVE' => 'üí´',
               'WIPE' => '‚ÜîÔ∏è',
               'MATCH_CUT' => 'üîÑ',
           ];
           $transitionIcon = $transitionIcons[$transition] ?? '‚úÇÔ∏è';
       @endphp
       <div style="padding: 0.6rem; background: rgba(139, 92, 246, 0.15); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
           <div style="font-size: 1.2rem;">{{ $transitionIcon }}</div>
           <div style="flex: 1;">
               <div style="font-size: 0.65rem; color: rgba(255,255,255,0.6); text-transform: uppercase; margin-bottom: 0.15rem;">Transition</div>
               <div style="font-size: 0.85rem; color: white; font-weight: 600;">{{ $transition }}</div>
           </div>
       </div>
       ```

    3. Location badge (META-03):
       ```blade
       {{-- Location --}}
       @php
           $location = $scene['location'] ?? null;
           if (is_array($location)) {
               $locationName = $location['name'] ?? 'Unknown Location';
           } else {
               $locationName = $location ?: 'Unknown Location';
           }
       @endphp
       <div style="padding: 0.6rem; background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
           <div style="font-size: 1.2rem;">üìç</div>
           <div style="flex: 1;">
               <div style="font-size: 0.65rem; color: rgba(255,255,255,0.6); text-transform: uppercase; margin-bottom: 0.15rem;">Location</div>
               <div style="font-size: 0.85rem; color: white; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ $locationName }}</div>
           </div>
       </div>
       ```

    Why semantic colors: Blue for duration (time), purple for transition (action), green for location (place). Matches storyboard badge color system for consistency. Icons make badges scannable without reading text.
  </action>
  <verify>
    Read scene-text-inspector.blade.php metadata grid section and confirm duration, transition, and location badges exist with proper fallback handling.
  </verify>
  <done>
    Modal displays duration (formatted MM:SS), transition (with type-specific icons), and location (with text truncation) in semantic colored badges.
  </done>
</task>

<task type="auto">
  <name>Add characters, intensity, and climax indicator badges</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/scene-text-inspector.blade.php</files>
  <action>
    Add META-04, META-05, META-06 badges to metadata grid:

    1. Characters badge (META-04):
       ```blade
       {{-- Characters --}}
       @php
           $characters = $scene['characters'] ?? [];
           if (!is_array($characters)) {
               $characters = [];
           }
           $characterCount = count($characters);
           $characterNames = collect($characters)->take(3)->map(function($char) {
               return is_array($char) ? ($char['name'] ?? 'Unknown') : $char;
           })->implode(', ');
           if ($characterCount > 3) {
               $characterNames .= " +{$characterCount - 3} more";
           }
       @endphp
       <div style="padding: 0.6rem; background: rgba(236, 72, 153, 0.15); border: 1px solid rgba(236, 72, 153, 0.3); border-radius: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
           <div style="font-size: 1.2rem;">üë•</div>
           <div style="flex: 1;">
               <div style="font-size: 0.65rem; color: rgba(255,255,255,0.6); text-transform: uppercase; margin-bottom: 0.15rem;">
                   Characters ({{ $characterCount }})
               </div>
               <div style="font-size: 0.85rem; color: white; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                   {{ $characterNames ?: 'None' }}
               </div>
           </div>
       </div>
       ```

    2. Emotional intensity badge (META-05):
       ```blade
       {{-- Emotional Intensity --}}
       @php
           $intensity = $scene['emotionalIntensity'] ?? $scene['intensity'] ?? 5;
           if (!is_numeric($intensity)) {
               $intensity = 5; // Default to medium
           }
           $intensity = max(1, min(10, (int)$intensity)); // Clamp 1-10

           // Color gradient: low (blue) -> medium (yellow) -> high (red)
           $intensityColors = [
               1 => ['bg' => 'rgba(59, 130, 246, 0.15)', 'border' => 'rgba(59, 130, 246, 0.3)', 'text' => '#60a5fa'],
               2 => ['bg' => 'rgba(59, 130, 246, 0.15)', 'border' => 'rgba(59, 130, 246, 0.3)', 'text' => '#60a5fa'],
               3 => ['bg' => 'rgba(16, 185, 129, 0.15)', 'border' => 'rgba(16, 185, 129, 0.3)', 'text' => '#34d399'],
               4 => ['bg' => 'rgba(16, 185, 129, 0.15)', 'border' => 'rgba(16, 185, 129, 0.3)', 'text' => '#34d399'],
               5 => ['bg' => 'rgba(251, 191, 36, 0.15)', 'border' => 'rgba(251, 191, 36, 0.3)', 'text' => '#fbbf24'],
               6 => ['bg' => 'rgba(251, 191, 36, 0.15)', 'border' => 'rgba(251, 191, 36, 0.3)', 'text' => '#fbbf24'],
               7 => ['bg' => 'rgba(249, 115, 22, 0.15)', 'border' => 'rgba(249, 115, 22, 0.3)', 'text' => '#fb923c'],
               8 => ['bg' => 'rgba(249, 115, 22, 0.15)', 'border' => 'rgba(249, 115, 22, 0.3)', 'text' => '#fb923c'],
               9 => ['bg' => 'rgba(239, 68, 68, 0.15)', 'border' => 'rgba(239, 68, 68, 0.3)', 'text' => '#f87171'],
               10 => ['bg' => 'rgba(239, 68, 68, 0.15)', 'border' => 'rgba(239, 68, 68, 0.3)', 'text' => '#f87171'],
           ];
           $intensityColor = $intensityColors[$intensity];
           $intensityLabel = $intensity <= 3 ? 'Low' : ($intensity <= 6 ? 'Medium' : 'High');
       @endphp
       <div style="padding: 0.6rem; background: {{ $intensityColor['bg'] }}; border: 1px solid {{ $intensityColor['border'] }}; border-radius: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
           <div style="font-size: 1.2rem;">üíì</div>
           <div style="flex: 1;">
               <div style="font-size: 0.65rem; color: rgba(255,255,255,0.6); text-transform: uppercase; margin-bottom: 0.15rem;">Intensity</div>
               <div style="font-size: 0.85rem; color: {{ $intensityColor['text'] }}; font-weight: 600;">
                   {{ $intensityLabel }} ({{ $intensity }}/10)
               </div>
           </div>
       </div>
       ```

    3. Climax badge (META-06) - prominent full-width badge:
       ```blade
       {{-- Climax Indicator (if applicable) --}}
       @php
           $isClimax = $scene['isClimax'] ?? $scene['climax'] ?? false;
       @endphp
       @if($isClimax)
       <div style="grid-column: 1 / -1; padding: 0.8rem 1rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.25), rgba(236, 72, 153, 0.25)); border: 2px solid rgba(236, 72, 153, 0.5); border-radius: 0.5rem; display: flex; align-items: center; gap: 0.75rem;">
           <div style="font-size: 1.5rem;">‚≠ê</div>
           <div style="flex: 1;">
               <div style="font-size: 0.9rem; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;">
                   üé¨ Climax Scene
               </div>
               <div style="font-size: 0.7rem; color: rgba(255,255,255,0.8); margin-top: 0.2rem;">
                   This is a pivotal moment in the narrative structure
               </div>
           </div>
       </div>
       @endif
       ```

    Why intensity gradient: Color progression (blue‚Üígreen‚Üíyellow‚Üíorange‚Üíred) provides instant visual understanding without reading numbers. Climax badge is full-width with gradient border to make it prominent and unmissable.
  </action>
  <verify>
    Read scene-text-inspector.blade.php and confirm characters badge (with truncation), intensity badge (with color gradient), and conditional climax badge exist.
  </verify>
  <done>
    Modal displays characters list (with +N more indicator), emotional intensity (with 1-10 gradient coloring), and prominent climax badge for pivotal scenes spanning full width.
  </done>
</task>

</tasks>

<verification>
Manual verification after execution:
1. Open Video Wizard storyboard and click Inspect on various scenes
2. Verify metadata section displays all 6 types:
   - Duration badge: Shows MM:SS format, handles 0 or missing gracefully
   - Transition badge: Shows correct transition type with icon (CUT, FADE, etc.)
   - Location badge: Shows location name with text-overflow ellipsis
   - Characters badge: Shows first 3 characters, +N more if applicable, (0) if none
   - Intensity badge: Color changes based on level (blue=low, yellow=med, red=high)
   - Climax badge: Only appears on climax scenes, spans full width, prominent styling
3. Test responsive grid on narrow browser window (mobile simulation)
4. Verify all badges handle missing/null data gracefully with sensible defaults
</verification>

<success_criteria>
- All 6 metadata types (META-01 through META-06) display correctly in modal
- Duration formatted as MM:SS (e.g., "02:45" for 165 seconds)
- Transition shows type-specific icon and label
- Location truncates with ellipsis if too long
- Characters shows first 3 with +N more indicator
- Intensity uses gradient colors (1-3 blue, 4-6 yellow, 7-10 red)
- Climax badge only shows on climax scenes, spans full width with gradient border
- Metadata badges use semantic colors matching storyboard design system
- Grid layout responsive (auto-fit minmax pattern)
- All metadata handles missing/null values with graceful defaults
- No console errors on scenes with incomplete metadata
</success_criteria>

<output>
After completion, create `.planning/phases/07-foundation-modal-shell-scene-card-fixes-metadata/07-03-SUMMARY.md`
</output>
