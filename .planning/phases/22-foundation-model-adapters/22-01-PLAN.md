---
phase: 22-foundation-model-adapters
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - modules/AppVideoWizard/app/Services/CinematographyVocabulary.php
  - modules/AppVideoWizard/app/Services/PromptTemplateLibrary.php
autonomous: true

must_haves:
  truths:
    - "Camera specifications include psychological reasoning - '85mm lens creates intimate compression'"
    - "Framing descriptions include quantified positions - 'subject occupies 40% of frame'"
    - "Lighting descriptions include specific values - 'key light at 5600K, fill at -2 stops'"
    - "Template library returns different structures based on shot type"
  artifacts:
    - path: "modules/AppVideoWizard/app/Services/CinematographyVocabulary.php"
      provides: "Camera psychology, lighting ratios, color temperatures, framing vocabulary"
      exports: ["LENS_PSYCHOLOGY", "LIGHTING_RATIOS", "COLOR_TEMPERATURES", "FRAMING_GEOMETRY"]
    - path: "modules/AppVideoWizard/app/Services/PromptTemplateLibrary.php"
      provides: "Shot-type organized templates with word budgets"
      exports: ["SHOT_TEMPLATES", "getTemplateForShotType"]
  key_links:
    - from: "PromptTemplateLibrary.php"
      to: "CinematographyVocabulary.php"
      via: "imports vocabulary constants for template construction"
      pattern: "CinematographyVocabulary::"
---

<objective>
Create professional cinematography vocabulary and shot-type template library for Hollywood-quality prompts.

Purpose: This phase builds the foundation for model-aware prompt generation. The vocabulary provides specific camera psychology, lighting ratios, and framing descriptions. The template library organizes prompts by shot type with appropriate word budgets.

Output:
- CinematographyVocabulary.php with lens psychology, lighting ratios (1:1 to 8:1), color temperatures (Kelvin), and framing geometry
- PromptTemplateLibrary.php with close-up/medium/wide/establishing templates, each with shot-specific word budgets and emphasis

Requirements covered: IMG-01, IMG-02, IMG-03, INF-03
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-foundation-model-adapters/22-RESEARCH.md
@modules/AppVideoWizard/app/Services/StructuredPromptBuilderService.php (existing presets to extend)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CinematographyVocabulary.php</name>
  <files>modules/AppVideoWizard/app/Services/CinematographyVocabulary.php</files>
  <action>
Create a new PHP class with professional cinematography constants:

1. **LENS_PSYCHOLOGY** - Array keyed by focal length (24mm, 35mm, 50mm, 85mm, 135mm):
   - `effect`: Physical description ("flattering compression, creamy bokeh")
   - `psychology`: Emotional reasoning ("creates intimacy, isolates subject from background")
   - `use_for`: Array of shot types this lens suits (["close-up", "medium-close"])
   - Include method `getLensForShotType(string $shotType): array` returning lens + psychology

2. **LIGHTING_RATIOS** - Array keyed by ratio (1:1, 2:1, 4:1, 8:1):
   - `description`: Technical description ("flat even lighting, key equals fill")
   - `mood`: Emotional quality ("commercial, beauty, innocence")
   - `stops_difference`: Numeric value (0, 1, 2, 3)
   - Include method `getRatioForMood(string $mood): array`

3. **COLOR_TEMPERATURES** - Array keyed by condition:
   - candlelight: 1900K, tungsten: 3200K, golden_hour: 3500K
   - daylight: 5600K, overcast: 6500K, shade: 7500K
   - Include method `getTemperatureDescription(string $condition): string` returning "5600K daylight"

4. **FRAMING_GEOMETRY** - Array with compositional positions:
   - thirds: ["left third intersection", "right third intersection", "upper third", "lower third"]
   - frame_percentages: [20 => "distant subject", 40 => "balanced presence", 60 => "dominant subject", 80 => "filling frame"]
   - Include method `buildFramingDescription(int $subjectPercentage, string $position): string`
     Returns: "subject occupies 40% of frame, positioned at left third intersection"

Use existing StructuredPromptBuilderService::CAMERA_PRESETS and LIGHTING_PRESETS as reference for vocabulary level. Extend, don't replace them.
  </action>
  <verify>
```bash
php artisan tinker --execute="
use Modules\AppVideoWizard\Services\CinematographyVocabulary;
\$v = new CinematographyVocabulary();
echo 'Lens for close-up: ' . json_encode(\$v->getLensForShotType('close-up')) . PHP_EOL;
echo 'Ratio for dramatic: ' . json_encode(\$v->getRatioForMood('dramatic')) . PHP_EOL;
echo 'Temp for golden_hour: ' . \$v->getTemperatureDescription('golden_hour') . PHP_EOL;
echo 'Framing: ' . \$v->buildFramingDescription(40, 'left third intersection') . PHP_EOL;
"
```
  </verify>
  <done>
- getLensForShotType('close-up') returns 85mm with psychology text
- getRatioForMood('dramatic') returns 4:1 ratio with stops_difference
- getTemperatureDescription('golden_hour') returns "3500K golden hour warmth"
- buildFramingDescription returns quantified position text
  </done>
</task>

<task type="auto">
  <name>Task 2: Create PromptTemplateLibrary.php</name>
  <files>modules/AppVideoWizard/app/Services/PromptTemplateLibrary.php</files>
  <action>
Create a new PHP class with shot-type organized templates:

1. **SHOT_TEMPLATES** - Array keyed by shot type:

   **close-up:**
   - emphasis: ['facial_detail', 'emotion', 'micro_expressions', 'eye_contact']
   - default_lens: '85mm'
   - word_budget: [subject => 35, action => 20, environment => 10, lighting => 18, style => 17]
   - priority_order: ['subject', 'action', 'lighting', 'environment', 'style']

   **medium:**
   - emphasis: ['body_language', 'gesture', 'subject_context', 'interaction']
   - default_lens: '50mm'
   - word_budget: [subject => 28, action => 20, environment => 20, lighting => 17, style => 15]
   - priority_order: ['subject', 'action', 'environment', 'lighting', 'style']

   **wide:**
   - emphasis: ['environment', 'spatial_context', 'scene_setting', 'atmosphere']
   - default_lens: '24mm'
   - word_budget: [subject => 20, action => 15, environment => 35, lighting => 15, style => 15]
   - priority_order: ['environment', 'subject', 'action', 'lighting', 'style']

   **establishing:**
   - emphasis: ['location', 'time_of_day', 'atmosphere', 'scale']
   - default_lens: '24mm'
   - word_budget: [subject => 10, action => 10, environment => 45, lighting => 20, style => 15]
   - priority_order: ['environment', 'lighting', 'subject', 'action', 'style']

   **extreme-close-up:**
   - emphasis: ['detail', 'texture', 'micro_expressions', 'emotional_intensity']
   - default_lens: '135mm'
   - word_budget: [subject => 45, action => 15, environment => 5, lighting => 20, style => 15]
   - priority_order: ['subject', 'lighting', 'action', 'style', 'environment']

2. **Methods:**
   - `getTemplateForShotType(string $shotType): array` - Returns template or defaults to 'medium'
   - `getWordBudget(string $shotType): array` - Returns word budget percentages
   - `getPriorityOrder(string $shotType): array` - Returns compression priority for this shot type
   - `getShotTypeFromContext(array $context): string` - Infers shot type from scene description

Use CinematographyVocabulary for lens lookups within templates.
  </action>
  <verify>
```bash
php artisan tinker --execute="
use Modules\AppVideoWizard\Services\PromptTemplateLibrary;
\$lib = new PromptTemplateLibrary();
echo 'Close-up template: ' . json_encode(\$lib->getTemplateForShotType('close-up')) . PHP_EOL;
echo 'Wide word budget: ' . json_encode(\$lib->getWordBudget('wide')) . PHP_EOL;
echo 'Priority for establishing: ' . json_encode(\$lib->getPriorityOrder('establishing')) . PHP_EOL;
"
```
  </verify>
  <done>
- Close-up template emphasizes facial_detail with 35% subject budget
- Wide template emphasizes environment with 35% environment budget
- Establishing template has environment as highest priority
- All shot types return valid templates with word_budget arrays summing to 100
  </done>
</task>

<task type="auto">
  <name>Task 3: Add Unit Tests</name>
  <files>modules/AppVideoWizard/tests/Unit/CinematographyVocabularyTest.php, modules/AppVideoWizard/tests/Unit/PromptTemplateLibraryTest.php</files>
  <action>
Create unit tests for both services:

**CinematographyVocabularyTest.php:**
- test_lens_psychology_includes_all_focal_lengths() - Assert 24mm, 35mm, 50mm, 85mm, 135mm present
- test_get_lens_for_close_up_returns_85mm() - Assert 85mm lens with psychology text
- test_lighting_ratios_have_stops_difference() - Assert each ratio has numeric stops
- test_color_temperatures_are_kelvin_values() - Assert values match expected Kelvin
- test_framing_description_includes_percentage() - Assert output contains "40% of frame"

**PromptTemplateLibraryTest.php:**
- test_all_shot_types_have_word_budgets() - Assert close-up, medium, wide, establishing all have budgets
- test_word_budgets_sum_to_100() - Assert each template's budget sums to 100%
- test_priority_orders_are_valid() - Assert priority arrays contain expected components
- test_unknown_shot_type_defaults_to_medium() - Assert fallback behavior
- test_close_up_prioritizes_subject() - Assert subject is first in priority

Run tests: `php artisan test --filter=Cinematography --filter=PromptTemplateLibrary`
  </action>
  <verify>
```bash
cd "C:\Users\VoltaPsy\Documents\GitHub\artime" && php artisan test --filter=Cinematography --filter=PromptTemplateLibrary
```
  </verify>
  <done>
- All tests pass
- Coverage includes all public methods
- Edge cases (unknown shot type) tested
  </done>
</task>

</tasks>

<verification>
```bash
# Verify services exist and are loadable
php artisan tinker --execute="
use Modules\AppVideoWizard\Services\CinematographyVocabulary;
use Modules\AppVideoWizard\Services\PromptTemplateLibrary;
echo 'CinematographyVocabulary loaded: ' . (class_exists(CinematographyVocabulary::class) ? 'YES' : 'NO') . PHP_EOL;
echo 'PromptTemplateLibrary loaded: ' . (class_exists(PromptTemplateLibrary::class) ? 'YES' : 'NO') . PHP_EOL;
"

# Run unit tests
php artisan test --filter=Cinematography --filter=PromptTemplateLibrary
```
</verification>

<success_criteria>
1. CinematographyVocabulary.php exists with LENS_PSYCHOLOGY, LIGHTING_RATIOS, COLOR_TEMPERATURES, FRAMING_GEOMETRY
2. PromptTemplateLibrary.php exists with SHOT_TEMPLATES for close-up, medium, wide, establishing, extreme-close-up
3. getLensForShotType('close-up') returns 85mm with "intimate compression" psychology
4. buildFramingDescription(40, 'left third') returns "subject occupies 40% of frame, positioned at left third intersection"
5. getWordBudget('wide') returns environment at 35%
6. All unit tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-model-adapters/22-01-SUMMARY.md`
</output>
